<section
  id="shopify-section-{{ section.id }}"
  class="vb-reviews"
  style="
    --vb-bg: {{ section.settings.bg_color }};
    --vb-text: {{ section.settings.text_color }};
    --vb-accent: {{ section.settings.accent_color }};
    --vb-border: {{ section.settings.border_color }};
    --vb-card: {{ section.settings.card_color }};
  "
>
  <div class="page-width">
    <header class="vb-reviews__head">
      {% if section.settings.heading != blank %}
        <h2>{{ section.settings.heading }}</h2>
      {% endif %}
      {% if section.settings.subheading != blank %}
        <p>{{ section.settings.subheading }}</p>
      {% endif %}
    </header>

    <div class="vb-reviews__track" role="list">
      {% for block in section.blocks %}
        <article class="vb-review-card" role="listitem" {{ block.shopify_attributes }}>
          <div class="vb-review-card__stars" aria-label="{{ block.settings.rating }} out of 5">
            {% for i in (1..5) %}
              <span class="{% if i <= block.settings.rating %}is-on{% endif %}">*</span>
            {% endfor %}
          </div>

          {% if block.settings.text != blank %}
            <blockquote>{{ block.settings.text }}</blockquote>
          {% endif %}

          <div class="vb-review-card__meta">
            {% if block.settings.name != blank %}
              <strong>{{ block.settings.name }}</strong>
            {% endif %}
            {% if block.settings.location != blank %}
              <p>{{ block.settings.location }}</p>
            {% endif %}
          </div>

          {% if block.settings.product_tag != blank %}
            <span class="vb-review-card__tag">{{ block.settings.product_tag }}</span>
          {% endif %}
        </article>
      {% endfor %}
    </div>
  </div>
</section>

<style>
  #shopify-section-{{ section.id }}.vb-reviews {
    background: var(--vb-bg);
    color: var(--vb-text);
    padding: 2.2rem 0;
  }

  #shopify-section-{{ section.id }} .vb-reviews__head {
    text-align: center;
    max-width: 60ch;
    margin: 0 auto 1.1rem;
  }

  #shopify-section-{{ section.id }} .vb-reviews__head h2 {
    margin: 0;
    font-size: clamp(1.35rem, 4.2vw, 2rem);
    line-height: 1.15;
    letter-spacing: -0.01em;
  }

  #shopify-section-{{ section.id }} .vb-reviews__head p {
    margin: 0.55rem 0 0;
    color: #4a5a4d;
    font-size: 0.96rem;
    line-height: 1.55;
  }

  #shopify-section-{{ section.id }} .vb-reviews__track {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: minmax(84%, 1fr);
    gap: 0.75rem;
    overflow-x: auto;
    padding-bottom: 0.2rem;
    scrollbar-width: none;
  }

  #shopify-section-{{ section.id }} .vb-reviews__track::-webkit-scrollbar {
    display: none;
  }

  #shopify-section-{{ section.id }} .vb-review-card {
    background: var(--vb-card);
    border: 1px solid var(--vb-border);
    border-radius: 1rem;
    padding: 0.95rem;
    display: grid;
    gap: 0.6rem;
  }

  #shopify-section-{{ section.id }} .vb-review-card__stars {
    color: #c8d8cc;
    font-size: 0.93rem;
    letter-spacing: 0.05em;
    line-height: 1;
  }

  #shopify-section-{{ section.id }} .vb-review-card__stars .is-on {
    color: color-mix(in srgb, var(--vb-accent) 88%, #4c6d53);
  }

  #shopify-section-{{ section.id }} .vb-review-card blockquote {
    margin: 0;
    font-size: 0.93rem;
    line-height: 1.55;
    color: #314235;
  }

  #shopify-section-{{ section.id }} .vb-review-card__meta strong {
    display: block;
    font-size: 0.86rem;
    line-height: 1.3;
  }

  #shopify-section-{{ section.id }} .vb-review-card__meta p {
    margin: 0.18rem 0 0;
    font-size: 0.78rem;
    color: #607164;
    line-height: 1.3;
  }

  #shopify-section-{{ section.id }} .vb-review-card__tag {
    justify-self: start;
    border: 1px solid color-mix(in srgb, var(--vb-accent) 40%, #d4e3d7);
    color: #264b33;
    background: #f4f9f5;
    border-radius: 999px;
    padding: 0.26rem 0.56rem;
    font-size: 0.74rem;
    line-height: 1.2;
  }

  @media screen and (min-width: 990px) {
    #shopify-section-{{ section.id }} .vb-reviews__track {
      grid-auto-flow: unset;
      grid-auto-columns: unset;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      overflow: visible;
      gap: 1rem;
    }
  }
</style>

{% schema %}
{
  "name": "Reviews section",
  "tag": "section",
  "class": "section section-reviews",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Resenas de la comunidad"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Historias reales de clientes VitalBoost."
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_color",
      "label": "Card color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#1f2a1f"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color",
      "default": "#9bbfa4"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#e2ebe4"
    }
  ],
  "blocks": [
    {
      "type": "review",
      "name": "Review",
      "settings": [
        {
          "type": "range",
          "id": "rating",
          "label": "Rating",
          "min": 1,
          "max": 5,
          "step": 1,
          "default": 5
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Review text",
          "default": "Excelente calidad y muy facil de incorporar a mi rutina diaria."
        },
        {
          "type": "text",
          "id": "name",
          "label": "Name",
          "default": "Cliente verificado"
        },
        {
          "type": "text",
          "id": "location",
          "label": "Location or context",
          "default": "Buenos Aires"
        },
        {
          "type": "text",
          "id": "product_tag",
          "label": "Optional product tag",
          "default": "Linea Belleza"
        }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Reviews section",
      "blocks": [
        {
          "type": "review",
          "settings": {
            "rating": 5,
            "name": "Martina C."
          }
        },
        {
          "type": "review",
          "settings": {
            "rating": 5,
            "name": "Franco L.",
            "product_tag": "Linea Sport"
          }
        },
        {
          "type": "review",
          "settings": {
            "rating": 4,
            "name": "Carla M.",
            "product_tag": "Linea Vitalidad"
          }
        }
      ]
    }
  ]
}
{% endschema %}
